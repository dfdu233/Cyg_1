<!--订单页-->
<cu-custom bgColor="bg-white" >
  <view slot="content"> 校园畅逸服务 </view>
</cu-custom>
<!--可滚动视图-->
<scroll-view scroll-x class="scroll_view">
  <!--scroll-x横向滚动-->
  <view class="tab">
    <view class="tab_item {{ tabNow === index ? 'select' : '' }}" wx:for="{{ tabList }}" data-index="{{ index }}" wx:key="index" bindtap="selectTab"data-type="tab">
      {{ item }}
    </view>
  </view>
</scroll-view>
<view class="tab_next">
  <view class="tab_next_item {{tab_nextNow === index ? 'selected' : '' }}" wx:for="{{tab_nextList}}" wx:key="index" bindtap="selectTab" data-index="{{index}}" data-type="tab_next">
    {{item}}
  </view>
</view>

<!--全部（我发布的）待完成部分-->
<view wx:if="{{ tabNow === 0&&tab_nextNow === 0}}" class="body">
  <view class="order" wx:for="{{ orderList }}" wx:key="index">
    <view class="order_top">
      <view class="top_left">
        <image src="{{ item.userInfo.avatarUrl }}"></image>
        <view class="name">
          <text>{{ item.name }}</text>
          <text>{{ item.time }}</text>
        </view>
      </view>
      <!--订单状态以及状态的颜色-->
      <view class="{{ item.stateColor }}">
        {{ item.state }}
      </view>
    </view>

    <view class="order_content">
      <view class="content">
        {{ item.info }}
      </view>
      <view class="address" wx:if="{{ item.name !== '游戏陪玩' }}">
        {{ item.state !== '已完成' ? '目的地：' + item.address : '' }}
      </view>
      <view class="address" wx:if="{{ openid === item.receivePerson }}">
        {{ item.state === '已帮助' && item.name === '快递代取' ? '取件码:' + item.expressCode : '' }}
      </view>
      <!--callPhone拨打电话-->
      <view class="address" bindtap="callPhone" data-phone="{{ item.phone }}">
        {{ item.state !== '已完成' ? '联系电话：' + item.phone : '订单已完成，相关信息已隐藏' }}
      </view>
      <view class="address" bindtap="callPhone" data-phone="{{ phoneNow }}" wx:if="{{ item.state !== '已完成' }}">
        {{ item.state === '待帮助' ? '接单员电话：（目前无人接单）' : '接单员电话：' + phoneNow }}
      </view>
    </view>

    <view class="order_bottom">
      <button wx:if="{{ item.name === '打印服务' && openid === item.receivePerson }}" size="mini" type="primary" bindtap="downloadFile" data-item="{{ item }}">下载文件</button>
      <button wx:if="{{ item.codeImg }}" size="mini" type="primary" bindtap="showCodeImg" data-item="{{ item }}">取件码截图</button>
      <button wx:if="{{ item.imgUrl }}" size="mini" type="primary" bindtap="showimgUrl" data-item="{{ item }}">快递代寄截图</button>
      <view class="money">
        金额 ￥{{ item.money }}
      </view>
      <view class="accept" wx:if="{{ item.state === '待帮助' }}" bindtap="orderReceive" data-item="{{ item }}">
        接单
      </view>
    </view>
  </view>
  <view class="showAll">
    ------- <text>已显示全部</text> -------
  </view>
</view>

<!--（我发布的）已完成部分-->
<view wx:if="{{ tabNow === 0&&tab_nextNow === 1}}" class="body">

  <view class="showAll">
    ------- <text>已显示全部</text> -------
  </view>
</view>

<!--我的订单（我下单的）待完成部分-->
<view wx:if="{{ tabNow === 1&&tab_nextNow===0 }}" class="body">

  <view class="order" wx:for="{{ myOrder }}" wx:key="index">
    <view class="order_top">
      <view class="top_left">
        <image src="{{ item.userInfo.avatarUrl }}"></image>
        <view class="name">
          <text>{{ item.name }}</text>
          <text>{{ item.time }}</text>
        </view>
      </view>
      <view class="{{ item.stateColor }}">
        {{ item.state }}
      </view>
    </view>

    <view class="order_content">
      <view class="content">
        {{ item.info }}
      </view>
      <view class="address" wx:if="{{ item.name !== '游戏陪玩' }}">
        {{ item.state !== '已完成' &&'目的地：' + item.address}}
      </view>
     <!-- <view class="address" wx:if="{{ openid === item.receivePerson }}">
        {{ item.state === '已帮助' && item.name === '快递代取' ? '取件码:' + item.expressCode : '' }}
      </view>-->
      <!--callPhone拨打电话-->
      <view class="address" bindtap="callPhone" data-phone="{{ item.phone }}">
        {{ item.state !== '已完成' && '联系电话：' + item.phone }}
      </view>
      <view class="address" bindtap="callPhone" data-phone="{{ phoneNow }}" wx:if="{{ item.state !== '已完成' }}">
        {{ item.state === '待帮助' && '接单员电话：（目前无人接单）'}}
      </view>
    </view>

    <view class="order_bottom">
      <button type="warn" size="mini" style="margin-right: 10rpx;" bindtap="deleteOrder" data-id="{{ item._id }}" wx:if="{{ item.state === '已帮助' }}">删除</button>
      <button type="warn" size="mini" style="margin-right: 10rpx;" bindtap="zhijiedeleteOrder" data-id="{{ item._id }}" wx:if="{{ item.state !== '已帮助' }}">删除</button>
      <!--在“我的订单”页，仅显示“删除”“金额”“订单状态”三个信息-->
      <!-- 
      <button wx:if="{{ item.name === '打印服务' && openid === item.receivePerson }}" size="mini" type="primary" bindtap="downloadFile" data-item="{{ item }}">下载文件</button>
      <button wx:if="{{ item.codeImg }}" size="mini" type="primary" bindtap="showCodeImg" data-item="{{ item }}">取件码</button>
      <button wx:if="{{ item.imgUrl }}" size="mini" type="primary" bindtap="showimgUrl" data-item="{{ item }}">快递代寄</button> 
      -->
      <view class="money">
        金额 ￥{{ item.money }}
      </view>
      <view class="accept" wx:if="{{ item.state === '已帮助' }}" bindtap="toFinish" data-item="{{ item }}">
        已完成
      </view>
    </view>
  </view>
  <view class="showAll">
    ------- <text>已显示全部</text> -------
  </view>
</view>

<!--（我下单的）已完成部分-->
<view wx:if="{{ tabNow === 1&&tab_nextNow===1 }}" class="body">

  <view class="order" wx:for="{{ myOrder }}" wx:key="index">
    <view class="order_top">
      <view class="top_left">
        <image src="{{ item.userInfo.avatarUrl }}"></image>
        <view class="name">
          <text>{{ item.name }}</text>
          <text>{{ item.time }}</text>
        </view>
      </view>
      <view class="{{ item.stateColor }}">
        {{ item.state }}
      </view>
    </view>

    <view class="order_content">
      <view class="content">
        {{ item.info }}
      </view>

      <view class="address" wx:if="{{ openid === item.receivePerson }}">
        {{ item.state === '已帮助' && item.name === '快递代取' && '取件码:' + item.expressCode }}
      </view>
      <!--callPhone拨打电话-->
      <view class="address" bindtap="callPhone" data-phone="{{ item.phone }}">
        {{ item.state === '已完成' && '订单已完成，相关信息已隐藏' }}
      </view>
      <view class="address" bindtap="callPhone" data-phone="{{ phoneNow }}" wx:if="{{ item.state !== '已完成' }}">
        {{ item.state !== '待帮助'&& '接单员电话：' + phoneNow }}
      </view>
    </view>

    <view class="order_bottom">
      <button type="warn" size="mini" style="margin-right: 10rpx;" bindtap="deleteOrder" data-id="{{ item._id }}" wx:if="{{ item.state === '已帮助' }}">删除</button>
      <button type="warn" size="mini" style="margin-right: 10rpx;" bindtap="zhijiedeleteOrder" data-id="{{ item._id }}" wx:if="{{ item.state !== '已帮助' }}">删除</button>
      <!--在“我的订单”页，仅显示“删除”“金额”“订单状态”三个信息-->
      <!-- 
      <button wx:if="{{ item.name === '打印服务' && openid === item.receivePerson }}" size="mini" type="primary" bindtap="downloadFile" data-item="{{ item }}">下载文件</button>
      <button wx:if="{{ item.codeImg }}" size="mini" type="primary" bindtap="showCodeImg" data-item="{{ item }}">取件码</button>
      <button wx:if="{{ item.imgUrl }}" size="mini" type="primary" bindtap="showimgUrl" data-item="{{ item }}">快递代寄</button> 
      -->
      <view class="money">
        金额 ￥{{ item.money }}
      </view>
      <view class="accept" wx:if="{{ item.state === '已帮助' }}" bindtap="toFinish" data-item="{{ item }}">
        已完成
      </view>
    </view>
  </view>

  <view class="showAll">
    ------- <text>已显示全部</text> -------
  </view>
</view>

<!--我帮助的，待完成部分-->
<view wx:if="{{ tabNow === 2&&tab_nextNow===0 }}" class="body">

  <view class="order" wx:for="{{ helpOrder }}" wx:key="index">
    <view class="order_top">
      <view class="top_left">
        <image src="{{ item.userInfo.avatarUrl }}"></image>
        <view class="name">
          <text>{{ item.name }}</text>
          <text>{{ item.time }}</text>
        </view>
      </view>
      <view class="{{ item.stateColor }}">
        {{ item.state }}
      </view>
    </view>

    <view class="order_content">
      <view class="content">
        {{ item.info }}
      </view>
      <view class="address" wx:if="{{ item.name !== '游戏陪玩' }}">
        {{ item.state !== '已完成' && '目的地：' + item.address}}
      </view>
     <!--<view class="address" wx:if="{{ openid === item.receivePerson }}">
        {{ item.state === '已帮助' && item.name === '快递代取' ? '取件码:' + item.expressCode : '' }}
      </view>-->
      <view class="address" bindtap="callPhone" data-phone="{{ item.phone }}">
        {{ item.state !== '已完成' && '联系电话：' + item.phone }}
      </view>
      <view class="address" bindtap="callPhone" data-phone="{{ phoneNow }}" wx:if="{{ item.state !== '已完成' }}">
        {{ item.state === '待帮助' && '接单员电话：（目前无人接单）' }}
      </view>
    </view>

    <view class="order_bottom">
      <view class="money">
        金额 ￥{{ item.money }}
      </view>
    </view>
  </view>
  <view class="showAll">
    ------- <text>已显示全部</text> -------
  </view>
</view>

<!--（我帮助的）已完成部分-->
<view wx:if="{{ tabNow === 2&&tab_nextNow===1 }}" class="body">

  <view class="helpOrderInfo">
    <view class="orderNum">
      <text>{{ helpTotalNum }}单</text>
      <text>已完成</text>
    </view>
    <view class="orderMoney">
      <text>{{ helpTotalMoeny }}元</text>
      <text>总收益</text>
    </view>
  </view>

  <view class="order" wx:for="{{ helpOrder }}" wx:key="index">
    <view class="order_top">
      <view class="top_left">
        <image src="{{ item.userInfo.avatarUrl }}"></image>
        <view class="name">
          <text>{{ item.name }}</text>
          <text>{{ item.time }}</text>
        </view>
      </view>
      <view class="{{ item.stateColor }}">
        {{ item.state }}
      </view>
    </view>

    <view class="order_content">
      <view class="content">
        {{ item.info }}
      </view>

      <view class="address" wx:if="{{ openid === item.receivePerson }}">
        {{ item.state === '已帮助' && item.name === '快递代取' && '取件码:' + item.expressCode}}
      </view>
      <view class="address" bindtap="callPhone" data-phone="{{ item.phone }}">
        {{ item.state === '已完成' && '订单已完成，相关信息已隐藏' }}
      </view>
      <view class="address" bindtap="callPhone" data-phone="{{ phoneNow }}" wx:if="{{ item.state !== '已完成' }}">
        {{ item.state !== '待帮助' &&'接单员电话：' + phoneNow }}
      </view>
    </view>

    <view class="order_bottom">
      <view class="money">
        金额 ￥{{ item.money }}
      </view>
    </view>
  </view>

  <view class="showAll">
    ------- <text>已显示全部</text> -------
  </view>
</view>